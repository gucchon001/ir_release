## 機能要件仕様書

### 1. システム概要
- **目的**: 本プログラムは、EDINET APIを利用して日本の有価証券報告書や四半期報告書を自動的に取得し、PDF形式のドキュメントを処理して要約を生成、それをGoogle Driveに保存し、Slackに通知します。金融機関や企業のIRチームが、効率的に報告書を管理し、関係者に迅速に情報を共有することを支援します。
- **対象ユーザー**: 金融機関のアナリスト、企業のIR担当者、投資家。

### 2. 主要機能要件
- **EDINETからのドキュメント取得**: EDINETのAPIを使用して、指定された期間内の報告書を取得。ユーザーはスプレッドシートを通じて取得するEDINETコードを指定可能。
- **PDFからのテキスト抽出と要約**: PyMuPDFを使用してPDFからテキストを抽出し、OpenAIのAPIを用いてテキストを要約。要約結果はGoogle Driveに保存。
- **Google Drive管理**: Google Drive APIを利用して、PDFと要約をクラウドにアップロードし、フォルダ管理を行う。
- **Slack通知**: 要約された情報をMarkdown形式でSlackに通知。事前に設定したSlackチャンネルに投稿。
- **スプレッドシートの管理**: Google Sheets APIを活用し、処理したデータのログをスプレッドシートに記録。ユーザーはスプレッドシートで処理対象を管理。

### 3. 非機能要件
- **パフォーマンス**: 並列処理を用いて、指定期間内のドキュメントを迅速に取得。最大スレッド数は10。
- **セキュリティ**: Googleサービスとの接続にはサービスアカウントを利用し、機密情報は`.env`ファイルで管理。
- **可用性**: エラーハンドリングを強化し、障害発生時に詳細なログを記録。ログは日次でローテーション。
- **スケーラビリティ**: スプレッドシートやAPIの設定を変更することで、新たな報告書や企業を簡単に追加可能。

### 4. 技術要件
- **プログラミング言語**: Python 3.8以上
- **外部ライブラリ**: `requests`, `google-api-python-client`, `PyMuPDF`, `openai`, `slack-sdk`, `tiktoken`, `sentence-transformers`, `dotenv`
- **実行環境**: 
  - OS: クロスプラットフォーム（Windows, macOS, Linux）
  - Google Cloudサービスと連携するため、インターネット接続が必要
- **依存関係の管理**: `requirements.txt`を使用してパッケージを管理
- **設定ファイル**: `settings.ini`と`secrets.env`でAPIキーや各種パラメータを管理

## 注意事項
- ソースコードを適切に配置し、`config`, `src`, `tests`ディレクトリを使用してプロジェクトを構成します。
- `.env`および設定ファイルのセキュリティを確保し、アクセス権を制限してください。