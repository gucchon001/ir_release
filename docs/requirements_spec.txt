## 機能要件仕様書

### 1. システム概要
- プログラムの目的は、EDINET APIを使用して金融関連のドキュメントを取得し、これらをGoogle Driveに保存した後、内容を要約してSlackに通知することです。
- 対象ユーザーは、金融業界内での情報取得を自動化したい企業や個人です。

### 2. 主要機能要件
- **EDINETドキュメント取得機能**: 指定された期間内のEDINETドキュメントを取得します。`EDINETOperations`クラスがこの機能を提供し、APIキーやベースURLなどの設定を`EDINETConfig`から取得します。
- **PDF処理機能**: 取得したPDFドキュメントからテキストを抽出し、要約を作成します。`pdfSummary`モジュール内の`extractor.py`と`summarizer.py`がこの機能をサポートします。
- **Google Driveとの連携**: ドキュメントデータをGoogle Driveに保存し、取得した要約も同様に保存します。`DriveHandler`クラスがDrive APIとのやり取りを担当します。
- **スプレッドシート操作**: スプレッドシートからEDINETコードを読み取り、取得したデータをログとして記録します。`SpreadsheetService`クラスがこの操作をサポートします。
- **Slack通知機能**: 要約された情報をSlackに通知します。`SlackNotifier`クラスがフォーマット済みのメッセージを送信します。

### 3. 非機能要件
- **パフォーマンス要件**: 大量のPDFを並列で処理するために、スレッドプールを使用してEDINETドキュメントの取得を高速化しています。最大10スレッドでの並列処理が可能です。
- **セキュリティ要件**: 環境変数や設定ファイルからAPIキーやサービスアカウント情報を読み取ります。これにより、コード内に機密情報をハードコーディングしないようにしています。
- **可用性**: プログラムはエラーハンドリングを行い、ログを詳細に記録することで、問題発生時の速やかな対応を可能にします。

### 4. 技術要件
- **開発環境**: Python 3.8以上を推奨します。依存関係は`requirements.txt`で管理されており、`pip install -r requirements.txt`でインストール可能です。
- **外部ライブラリ**: 
  - `googleapiclient`および`google-auth`はGoogle Drive APIとの連携に使用されます。
  - `requests`はHTTPリクエストを送信するために使用されます。
  - `openai`はテキスト要約の生成に使用されます。
  - `pymupdf`はPDFからテキストを抽出するために使用されます。
- **OS要件**: 特定のOSに依存しないが、Google Drive連携のためにネットワーク接続が必要です。
- **設定ファイル**: `config/settings.ini`および`config/secrets.env`により、環境設定やAPIキーを管理します。

このシステムは、金融関連業務における情報の取得と処理を効率化し、ユーザーが迅速かつ正確に意思決定を行えるよう支援します。